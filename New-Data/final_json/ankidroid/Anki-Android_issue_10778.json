{
    "url": "https://api.github.com/repos/ankidroid/Anki-Android/issues/10778",
    "repository_url": "https://api.github.com/repos/ankidroid/Anki-Android",
    "labels_url": "https://api.github.com/repos/ankidroid/Anki-Android/issues/10778/labels{/name}",
    "comments_url": "https://api.github.com/repos/ankidroid/Anki-Android/issues/10778/comments",
    "events_url": "https://api.github.com/repos/ankidroid/Anki-Android/issues/10778/events",
    "html_url": "https://github.com/ankidroid/Anki-Android/pull/10778",
    "id": 1199337159,
    "node_id": "PR_kwDOAHXAE841-GfL",
    "number": 10778,
    "title": "Minor Fix for DeckPicker Translation/String Resource Issue",
    "user": {
        "login": "raymondwzeng",
        "id": 13594022,
        "node_id": "MDQ6VXNlcjEzNTk0MDIy",
        "avatar_url": "https://avatars.githubusercontent.com/u/13594022?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/raymondwzeng",
        "html_url": "https://github.com/raymondwzeng",
        "followers_url": "https://api.github.com/users/raymondwzeng/followers",
        "following_url": "https://api.github.com/users/raymondwzeng/following{/other_user}",
        "gists_url": "https://api.github.com/users/raymondwzeng/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/raymondwzeng/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/raymondwzeng/subscriptions",
        "organizations_url": "https://api.github.com/users/raymondwzeng/orgs",
        "repos_url": "https://api.github.com/users/raymondwzeng/repos",
        "events_url": "https://api.github.com/users/raymondwzeng/events{/privacy}",
        "received_events_url": "https://api.github.com/users/raymondwzeng/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": {
        "url": "https://api.github.com/repos/ankidroid/Anki-Android/milestones/42",
        "html_url": "https://github.com/ankidroid/Anki-Android/milestone/42",
        "labels_url": "https://api.github.com/repos/ankidroid/Anki-Android/milestones/42/labels",
        "id": 6623046,
        "node_id": "MDk6TWlsZXN0b25lNjYyMzA0Ng==",
        "number": 42,
        "title": "2.16 release",
        "description": "",
        "creator": {
            "login": "mikehardy",
            "id": 782704,
            "node_id": "MDQ6VXNlcjc4MjcwNA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/782704?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mikehardy",
            "html_url": "https://github.com/mikehardy",
            "followers_url": "https://api.github.com/users/mikehardy/followers",
            "following_url": "https://api.github.com/users/mikehardy/following{/other_user}",
            "gists_url": "https://api.github.com/users/mikehardy/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mikehardy/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mikehardy/subscriptions",
            "organizations_url": "https://api.github.com/users/mikehardy/orgs",
            "repos_url": "https://api.github.com/users/mikehardy/repos",
            "events_url": "https://api.github.com/users/mikehardy/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mikehardy/received_events",
            "type": "User",
            "site_admin": false
        },
        "open_issues": 4,
        "closed_issues": 3585,
        "state": "open",
        "created_at": "2021-04-04T15:15:20Z",
        "updated_at": "2023-08-28T20:58:04Z",
        "due_on": null,
        "closed_at": null
    },
    "comments": 0,
    "created_at": "2022-04-11T03:28:20Z",
    "updated_at": "2022-04-13T00:44:58Z",
    "closed_at": "2022-04-13T00:44:45Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "draft": false,
    "pull_request": {
        "url": "https://api.github.com/repos/ankidroid/Anki-Android/pulls/10778",
        "html_url": "https://github.com/ankidroid/Anki-Android/pull/10778",
        "diff_url": "https://github.com/ankidroid/Anki-Android/pull/10778.diff",
        "patch_url": "https://github.com/ankidroid/Anki-Android/pull/10778.patch",
        "merged_at": "2022-04-13T00:44:45Z"
    },
    "body": "## Purpose / Description\r\nThere exists a resource string/translation issue on the current builds of AnkiDroid such that when the user switches between 2 languages, the time indicator of the action bar does not translate over. This can be alleviated by restarting AnkiDroid.\r\n\r\n## Fixes\r\nFixes #10772.\r\n\r\n## Approach\r\nSwitching the context passed into the Util method from Application to Activity context seemed to resolve the issue.\r\n\r\n## How Has This Been Tested?\r\n\r\nThis was manually tested on my OnePlus 8T, running Android 11. Switching between English and Japanese (and vice-versa) now produces the correct behavior. Attached is a video of the new, expected behavior.\r\n\r\nhttps://user-images.githubusercontent.com/13594022/162661738-779693e5-00df-41ee-b12e-5e517edb6a9c.mp4\r\n\r\n\r\nIn addition to the manual testing, the suite of unit tests that exists for DeckPicker.java was run to ensure that no regressions occurred from this change. This returned a 100% pass rate, though 1 test was ignored:\r\n![image](https://user-images.githubusercontent.com/13594022/162659783-deaa474f-4c9f-4394-a772-55a5bc099b4f.png)\r\n\r\n## Learning (optional, can help others)\r\nHonestly, this one's a headscratcher. After finding the method, I quickly tested out calling the resource string from within the method that ultimately set the action bar subtitle, and that seemed to produce the correct result. Naively copy-pasting the implementation of the utility function seemed to show that it wasn't an error in implementation and moving the method call to later into the method also seemed to show that it wasn't an issue with timing. \r\n\r\nI decided to give a shot of passing in the Activity context rather than grabbing the application context, and lo and behold, it works. If anyone has an explanation on why the activity would update quicker than the application, I'm all ears.\r\n\r\nAlso funnily enough, in the course of fixing this error, I found another one related to the \"system default\" option (seems like selecting the option after a restart fails to translate the app in its entirety until another restart, perhaps a similar issue?). I'll have to run through the issue process to make sure it isn't a duplicate or has been fixed and hope to have it up soon.\r\n\r\n## Checklist\r\n_Please, go through these checks before submitting the PR._\r\n\r\n- [x] You have not changed whitespace unnecessarily (it makes diffs hard to read)\r\n- [x] You have a descriptive commit message with a short title (first line, max 50 chars).\r\n- [x] Your code follows the style of the project (e.g. never omit braces in `if` statements) \r\n- [x] You have commented your code, particularly in hard-to-understand areas\r\n- [x] You have performed a self-review of your own code\r\n- [ ] UI changes: include screenshots of all affected screens (in particular showing any new or changed strings)\r\n- [ ] UI Changes: You have tested your change using the [Google Accessibility Scanner](https://play.google.com/store/apps/details?id=com.google.android.apps.accessibility.auditor)\r\n",
    "closed_by": {
        "login": "mikehardy",
        "id": 782704,
        "node_id": "MDQ6VXNlcjc4MjcwNA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/782704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehardy",
        "html_url": "https://github.com/mikehardy",
        "followers_url": "https://api.github.com/users/mikehardy/followers",
        "following_url": "https://api.github.com/users/mikehardy/following{/other_user}",
        "gists_url": "https://api.github.com/users/mikehardy/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/mikehardy/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/mikehardy/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehardy/orgs",
        "repos_url": "https://api.github.com/users/mikehardy/repos",
        "events_url": "https://api.github.com/users/mikehardy/events{/privacy}",
        "received_events_url": "https://api.github.com/users/mikehardy/received_events",
        "type": "User",
        "site_admin": false
    },
    "reactions": {
        "url": "https://api.github.com/repos/ankidroid/Anki-Android/issues/10778/reactions",
        "total_count": 1,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 1,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/ankidroid/Anki-Android/issues/10778/timeline",
    "performed_via_github_app": null,
    "state_reason": null
}