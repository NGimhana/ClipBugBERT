{
    "url": "https://api.github.com/repos/getodk/collect/issues/5264",
    "repository_url": "https://api.github.com/repos/getodk/collect",
    "labels_url": "https://api.github.com/repos/getodk/collect/issues/5264/labels{/name}",
    "comments_url": "https://api.github.com/repos/getodk/collect/issues/5264/comments",
    "events_url": "https://api.github.com/repos/getodk/collect/issues/5264/events",
    "html_url": "https://github.com/getodk/collect/issues/5264",
    "id": 1351007891,
    "node_id": "I_kwDOAmWdMc5Qhr6T",
    "number": 5264,
    "title": "Removing one of the groups in nested repeats forms and clicking the back button causes the crash of the app",
    "user": {
        "login": "dbemke",
        "id": 56479916,
        "node_id": "MDQ6VXNlcjU2NDc5OTE2",
        "avatar_url": "https://avatars.githubusercontent.com/u/56479916?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dbemke",
        "html_url": "https://github.com/dbemke",
        "followers_url": "https://api.github.com/users/dbemke/followers",
        "following_url": "https://api.github.com/users/dbemke/following{/other_user}",
        "gists_url": "https://api.github.com/users/dbemke/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/dbemke/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/dbemke/subscriptions",
        "organizations_url": "https://api.github.com/users/dbemke/orgs",
        "repos_url": "https://api.github.com/users/dbemke/repos",
        "events_url": "https://api.github.com/users/dbemke/events{/privacy}",
        "received_events_url": "https://api.github.com/users/dbemke/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 807015281,
            "node_id": "MDU6TGFiZWw4MDcwMTUyODE=",
            "url": "https://api.github.com/repos/getodk/collect/labels/behavior%20verified",
            "name": "behavior verified",
            "color": "ededed",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "grzesiek2010",
        "id": 3276264,
        "node_id": "MDQ6VXNlcjMyNzYyNjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3276264?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/grzesiek2010",
        "html_url": "https://github.com/grzesiek2010",
        "followers_url": "https://api.github.com/users/grzesiek2010/followers",
        "following_url": "https://api.github.com/users/grzesiek2010/following{/other_user}",
        "gists_url": "https://api.github.com/users/grzesiek2010/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/grzesiek2010/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/grzesiek2010/subscriptions",
        "organizations_url": "https://api.github.com/users/grzesiek2010/orgs",
        "repos_url": "https://api.github.com/users/grzesiek2010/repos",
        "events_url": "https://api.github.com/users/grzesiek2010/events{/privacy}",
        "received_events_url": "https://api.github.com/users/grzesiek2010/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "grzesiek2010",
            "id": 3276264,
            "node_id": "MDQ6VXNlcjMyNzYyNjQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3276264?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/grzesiek2010",
            "html_url": "https://github.com/grzesiek2010",
            "followers_url": "https://api.github.com/users/grzesiek2010/followers",
            "following_url": "https://api.github.com/users/grzesiek2010/following{/other_user}",
            "gists_url": "https://api.github.com/users/grzesiek2010/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/grzesiek2010/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/grzesiek2010/subscriptions",
            "organizations_url": "https://api.github.com/users/grzesiek2010/orgs",
            "repos_url": "https://api.github.com/users/grzesiek2010/repos",
            "events_url": "https://api.github.com/users/grzesiek2010/events{/privacy}",
            "received_events_url": "https://api.github.com/users/grzesiek2010/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": {
        "url": "https://api.github.com/repos/getodk/collect/milestones/31",
        "html_url": "https://github.com/getodk/collect/milestone/31",
        "labels_url": "https://api.github.com/repos/getodk/collect/milestones/31/labels",
        "id": 8509145,
        "node_id": "MI_kwDOAmWdMc4AgdbZ",
        "number": 31,
        "title": "v2023.1",
        "description": "",
        "creator": {
            "login": "seadowg",
            "id": 556280,
            "node_id": "MDQ6VXNlcjU1NjI4MA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/556280?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/seadowg",
            "html_url": "https://github.com/seadowg",
            "followers_url": "https://api.github.com/users/seadowg/followers",
            "following_url": "https://api.github.com/users/seadowg/following{/other_user}",
            "gists_url": "https://api.github.com/users/seadowg/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/seadowg/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/seadowg/subscriptions",
            "organizations_url": "https://api.github.com/users/seadowg/orgs",
            "repos_url": "https://api.github.com/users/seadowg/repos",
            "events_url": "https://api.github.com/users/seadowg/events{/privacy}",
            "received_events_url": "https://api.github.com/users/seadowg/received_events",
            "type": "User",
            "site_admin": false
        },
        "open_issues": 0,
        "closed_issues": 49,
        "state": "closed",
        "created_at": "2022-10-05T14:21:56Z",
        "updated_at": "2023-04-07T08:25:00Z",
        "due_on": null,
        "closed_at": "2023-04-07T08:25:00Z"
    },
    "comments": 4,
    "created_at": "2022-08-25T14:38:40Z",
    "updated_at": "2023-03-14T15:26:28Z",
    "closed_at": "2023-03-14T15:26:28Z",
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "**Software and hardware versions** \r\n\r\nCollect v2021.1.2,  Android probably all\r\n\r\n**Problem description**\r\n\r\nWhen the user removes a group (one of at least 2 groups) in a nested repeats form, clicking the device back button causes a crash. On Android 5.1 clicking the back button instead of crashing restores the removed group. On Android 12 the user needs to remove 2 groups to cause the crash of the app.\r\n\r\n**Steps to reproduce the problem**\r\n\r\n1. Go to nested-repeats form.\r\n[nested-repeats.xml.txt](https://github.com/getodk/collect/files/9425583/nested-repeats.xml.txt)\r\n2. Add a \"Friend\".\r\n3. Enter a name.\r\n4. Click next.\r\n5. Add a \"Pet\".\r\n6. Enter a name.\r\n7. Click next.\r\n8. Do not add another pet.\r\n9. Add a \"Friend\".\r\n10. Enter a name.\r\n11.Click next.\r\n12. Add a \"Pet\".\r\n13. Enter a name.\r\n14. Go to the hierarchy view.\r\n15. Click the vertical arrow twice (so that you can see: \"What is friend#2\u2019s name?\" and \"Pets \u2013 Repeatable Group\").\r\n16. Click the bin.\r\n17. Click remove group.\r\n18. Click the device back button.\r\n\r\nhttps://user-images.githubusercontent.com/56479916/186692360-5c90d0bb-4874-49d9-aca8-858cc81636d9.mp4\r\n\r\n\r\n\r\n**Expected behavior**\r\n\r\nThe group should be removed. The app shouldn\u2019t crash.\r\n\r\n**Other information**\r\n\r\nI haven\u2019t checked earlier versions of ODK Collect than v2021.1.2.\r\nThe crash in Logcat from Android 11:\r\n\r\n`2022-08-25 10:46:20.112 25127-25127/? E/MessageQueue-JNI: java.lang.NullPointerException: Attempt to invoke virtual method 'boolean org.javarosa.core.model.instance.TreeElement.isRelevant()' on a null object reference\r\n        at org.javarosa.core.model.FormDef.isRepeatRelevant(FormDef.java:548)\r\n        at org.javarosa.form.api.FormEntryModel.isIndexRelevant(FormEntryModel.java:383)\r\n        at org.javarosa.form.api.FormEntryController.stepEvent(FormEntryController.java:217)\r\n        at org.javarosa.form.api.FormEntryController.stepToPreviousEvent(FormEntryController.java:198)\r\n        at org.odk.collect.android.javarosawrapper.FormController.stepToPreviousEvent(FormController.java:785)\r\n        at org.odk.collect.android.activities.FormHierarchyActivity.navigateToTheLastRelevantIndex(FormHierarchyActivity.java:775)\r\n        at org.odk.collect.android.activities.FormHierarchyActivity.onBackPressed(FormHierarchyActivity.java:749)\r\n        at android.app.Activity.onKeyUp(Activity.java:3841)\r\n        at android.view.KeyEvent.dispatch(KeyEvent.java:3648)\r\n        at android.app.Activity.dispatchKeyEvent(Activity.java:4147)\r\n        at androidx.core.app.ComponentActivity.superDispatchKeyEvent(ComponentActivity.java:122)\r\n        at androidx.core.view.KeyEventDispatcher.dispatchKeyEvent(KeyEventDispatcher.java:84)\r\n        at androidx.core.app.ComponentActivity.dispatchKeyEvent(ComponentActivity.java:140)\r\n        at androidx.appcompat.app.AppCompatActivity.dispatchKeyEvent(AppCompatActivity.java:599)\r\n        at androidx.appcompat.view.WindowCallbackWrapper.dispatchKeyEvent(WindowCallbackWrapper.java:59)\r\n        at androidx.appcompat.app.AppCompatDelegateImpl$AppCompatWindowCallback.dispatchKeyEvent(AppCompatDelegateImpl.java:3090)\r\n        at com.android.internal.policy.DecorView.dispatchKeyEvent(DecorView.java:758)\r\n        at android.view.ViewRootImpl$ViewPostImeInputStage.processKeyEvent(ViewRootImpl.java:7365)\r\n        at android.view.ViewRootImpl$ViewPostImeInputStage.onProcess(ViewRootImpl.java:7191)\r\n        at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:6595)\r\n        at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:6652)\r\n        at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:6618)\r\n        at android.view.ViewRootImpl$AsyncInputStage.forward(ViewRootImpl.java:6786)\r\n        at android.view.ViewRootImpl$InputStage.apply(ViewRootImpl.java:6626)\r\n        at android.view.ViewRootImpl$AsyncInputStage.apply(ViewRootImpl.java:6843)\r\n        at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:6599)\r\n        at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:6652)\r\n        at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:6618)\r\n        at android.view.ViewRootImpl$InputStage.apply(ViewRootImpl.java:6626)\r\n        at android.view.ViewRootImpl$InputStage.deliver(ViewRootImpl.java:6599)\r\n        at android.view.ViewRootImpl$InputStage.onDeliverToNext(ViewRootImpl.java:6652)\r\n        at android.view.ViewRootImpl$InputStage.forward(ViewRootImpl.java:6618)\r\n        at android.view.ViewRootImpl$AsyncInputStage.forward(ViewRootImpl.java:6819)\r\n        at android.view.ViewRootImpl$ImeInputStage.onFinishedInputEvent(ViewRootImpl.java:7007)\r\n        at android.view.inputmethod.InputMethodManager$PendingEvent.run(InputMethodManager.java:3624)\r\n        at android.view.inputmethod.InputMethodManager.invokeFinishedInputEventCallback(InputMethodManager.java:3163)\r\n        at android.view.inputmethod.InputMethodManager.finishedInputEvent(InputMethodManager.java:3154)\r\n        at android.view.inputmethod.InputMethodManager$ImeInputEventSender.onInputEventFinished(InputMethodManager.java:3601)\r\n        at android.view.InputEventSender.dispatchInputEventFinished(InputEventSender.java:143)\r\n        at android.os.MessageQueue.nativePollOnce(Native Method)\r\n        at android.os.MessageQueue.next(MessageQueue.java:335)\r\n        at android.os.Looper.loop(Looper.java:206)\r\n        at android.app.ActivityThread.main(ActivityThread.java:8633)\r\n        at java.lang.reflect.Method.invoke(Native Method)\r\n        at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:602)\r\n        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:1130)`\r\n",
    "closed_by": {
        "login": "grzesiek2010",
        "id": 3276264,
        "node_id": "MDQ6VXNlcjMyNzYyNjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3276264?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/grzesiek2010",
        "html_url": "https://github.com/grzesiek2010",
        "followers_url": "https://api.github.com/users/grzesiek2010/followers",
        "following_url": "https://api.github.com/users/grzesiek2010/following{/other_user}",
        "gists_url": "https://api.github.com/users/grzesiek2010/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/grzesiek2010/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/grzesiek2010/subscriptions",
        "organizations_url": "https://api.github.com/users/grzesiek2010/orgs",
        "repos_url": "https://api.github.com/users/grzesiek2010/repos",
        "events_url": "https://api.github.com/users/grzesiek2010/events{/privacy}",
        "received_events_url": "https://api.github.com/users/grzesiek2010/received_events",
        "type": "User",
        "site_admin": false
    },
    "reactions": {
        "url": "https://api.github.com/repos/getodk/collect/issues/5264/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/getodk/collect/issues/5264/timeline",
    "performed_via_github_app": null,
    "state_reason": "completed"
}